(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3212a7ba"],{"06e2":function(e,t,s){},"1f58":function(e,t,s){"use strict";s("6e07")},"2b38":function(e,t,s){"use strict";s("06e2")},"6e07":function(e,t,s){},"91c5":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[e._m(0),s("div",{staticClass:"main-body"},[s("div",{staticClass:"main-title margin-bottom-20"},[s("Row",{attrs:{gutter:20,justify:"space-between"}},[s("i-col",{staticClass:"text-left",attrs:{span:16}},[s("Row",{attrs:{gutter:20}},[s("i-col",{attrs:{span:6}},[s("Input",{attrs:{placeholder:"请输入姓名",size:"large",clearable:""},model:{value:e.queryForm.realUserName,callback:function(t){e.$set(e.queryForm,"realUserName",t)},expression:"queryForm.realUserName"}})],1),s("i-col",{attrs:{span:6}},[s("Select",{attrs:{size:"large",placeholder:"请选择部门",filterable:"",clearable:""},model:{value:e.queryForm.groupId,callback:function(t){e.$set(e.queryForm,"groupId",t)},expression:"queryForm.groupId"}},e._l(e.deptList,(function(t){return s("Option",{key:t.groupId+t.groupName,attrs:{value:t.groupId}},[e._v(" "+e._s(t.groupName)+" ")])})),1)],1),s("i-col",{attrs:{span:3}},[s("Button",{directives:[{name:"debounce",rawName:"v-debounce"}],attrs:{size:"large",type:"primary"},on:{click:e.searchComm}},[s("span",{staticClass:"fa fa-search"})])],1)],1)],1),s("i-col",{staticClass:"text-left add-btn",attrs:{span:2}},[s("Button",{directives:[{name:"debounce",rawName:"v-debounce"}],staticClass:"add-btn",attrs:{size:"large",type:"primary"},on:{click:function(t){return e.updatePerson(0)}}},[e._v(" 新增 ")])],1)],1)],1),e.hasList?s("div",[s("div",{staticClass:"page-table margin-bottom-20"},[s("Table",{attrs:{columns:e.columns,stripe:"",data:e.dataList},scopedSlots:e._u([{key:"gitLabUser",fn:function(t){var a=t.row;return e._l(a.gitLabUser,(function(t,r){return s("div",{key:t.userId},[s("span",[e._v(e._s(t.userName)+e._s(r+1===a.gitLabUser.length?"":"、"))]),s("br")])}))}},{key:"groupList",fn:function(t){var a=t.row;return[s("div",{staticClass:"actionLink"},e._l(a.groupList,(function(t,a){return s("Tag",{key:a,attrs:{color:"cyan"}},[e._v(" "+e._s(t.groupName)+" ")])})),1)]}},{key:"action",fn:function(t){var a=t.row;return[s("div",[s("Button",{staticClass:"delete-btn",attrs:{type:"dashed",icon:"ios-trash-outline"},on:{click:function(t){return e.deletePerson(a.realUserId)}}},[e._v("删除")]),s("Button",{staticClass:"action-btn",attrs:{type:"dashed",icon:"ios-create"},on:{click:function(t){return e.updatePerson(1,a)}}},[e._v("修改")])],1)]}}],null,!1,1901713900)})],1),s("div",{staticClass:"page-footer text-center"},[s("Page",{attrs:{total:e.itemTotal,"page-size-opts":[10,20,40],current:e.pageIndex,"page-size":e.pageSize,"show-elevator":"","show-total":"","show-sizer":""},on:{"on-page-size-change":e.getPageSize,"on-change":e.getPageList}})],1)]):s("div",{staticClass:"main-none"},[s("noListData")],1)]),s("div",{staticClass:"content_win"},[s("confirmModal",{ref:"confirmModal",on:{entrueClose:e.cancelClose}},[s("div",{attrs:{slot:"info"},slot:"info"},[s("p",{staticClass:"p-text"},[e._v("确定删除该人员？")])])]),s("editRealPerson",{ref:"editPerson",on:{getList:e.getList}})],1)])},r=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page-header margin-bottom-20"},[s("h3",[e._v("人员管理")])])}],i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"editRoleModal page"},[s("Modal",{staticClass:"page-modal",attrs:{width:"35%",title:e.title,scrollable:!1,"footer-hide":!0,"class-name":"vertical-center-modal",styles:{top:"-30px"}},model:{value:e.dialogVisible,callback:function(t){e.dialogVisible=t},expression:"dialogVisible"}},[e.loadingShow?s("Spin",{attrs:{fix:""}},[s("Icon",{staticClass:"demo-spin-icon-load",attrs:{type:"ios-loading",size:"18"}}),s("div",[e._v("Loading")])],1):e._e(),s("div",{staticClass:"modalContainer margin-bottom-100"},[s("Form",{ref:"addForm",staticClass:"form-box",attrs:{"label-width":130,model:e.addForm,"label-colon":"",rules:e.ruleValidate}},[s("FormItem",{attrs:{label:"姓名",prop:"realUserName"}},[s("Input",{attrs:{size:"large",maxlength:10,placeholder:"请输入姓名",clearable:""},model:{value:e.addForm.realUserName,callback:function(t){e.$set(e.addForm,"realUserName",t)},expression:"addForm.realUserName"}})],1),s("FormItem",{attrs:{label:"邮箱"}},[s("Input",{attrs:{size:"large",placeholder:"请输入邮箱",clearable:""},model:{value:e.addForm.realEmail,callback:function(t){e.$set(e.addForm,"realEmail",t)},expression:"addForm.realEmail"}})],1),s("FormItem",{attrs:{label:"gitlab账号"}},[s("Select",{attrs:{filterable:"",multiple:""},model:{value:e.addForm.userIds,callback:function(t){e.$set(e.addForm,"userIds",t)},expression:"addForm.userIds"}},e._l(e.userLists,(function(t){return s("Option",{key:t.userId,attrs:{value:t.userId}},[e._v(e._s(t.userName))])})),1)],1),s("FormItem",{attrs:{label:"部门"}},[s("Select",{attrs:{filterable:"",multiple:""},model:{value:e.addForm.groups,callback:function(t){e.$set(e.addForm,"groups",t)},expression:"addForm.groups"}},e._l(e.deptTypes,(function(t){return s("Option",{key:t.groupId,attrs:{value:t.groupId}},[e._v(e._s(t.groupName))])})),1)],1)],1)],1),s("div",{staticClass:"detailBackBtn margin-bottom-40"},[s("Button",{attrs:{size:"large"},on:{click:function(t){return e.closeModal()}}},[e._v(e._s(e.$t("common.cancel")))]),s("Button",{attrs:{type:"primary",size:"large"},on:{click:function(t){return e.handleSubmit()}}},[e._v(e._s(e.$t("common.ensure")))])],1)],1)],1)},o=[],n={name:"addModal",data:function(){return{loadingShow:!1,cardtype:0,dialogVisible:!1,resultType:!0,addForm:{realUserName:"",userRealName:"",dept:"",userEmail:""},ruleValidate:{realUserName:[{required:!0,message:"请输入姓名",trigger:"blur"}]},randomModal:!1,loginTime:"",deptTypes:[],userLists:[],isEdit:!1,row:{},disabled:!1,timer:null,ipAddress:"",title:"新增"}},computed:{},watch:{dialogVisible:function(e){e?(this.addForm=this.row,this.getDeptList(),this.getUsersList()):(this.handleReset(),this.$emit("getList"),clearInterval(this.timer))},isEdit:function(e){this.disabled=!!e}},mounted:function(){},beforeDestroy:function(){clearInterval(this.timer)},methods:{handleReset:function(){this.$refs.addForm.resetFields(),this.loginTime="",this.addForm=this.$options.data.call(this).addForm},closeModal:function(){this.dialogVisible=!1,this.handleReset(),clearInterval(this.timer)},handleSubmit:function(){console.log("点击确定按钮",this.addForm);var e=this;this.$refs.addForm.validate((function(t){t&&e.updatePerson()}))},getDeptList:function(){var e=this;this.$store.dispatch("deptManager/getDeptList").then((function(t){console.log(t),e.deptTypes=t.data})).catch((function(){}))},getUsersList:function(){var e=this;this.$store.dispatch("personManager/getRealUserList").then((function(t){console.log(t),e.userLists=t.data})).catch((function(){}))},updatePerson:function(){var e=this;this.$store.dispatch("personManager/updatePerson",this.addForm).then((function(t){console.log(t),404!==Number(t.code)?(e.$message({type:"success",message:"操作成功"}),e.$emit("getList"),e.dialogVisible=!1):e.$message({type:"error",message:t.message+"，请重新输入"})})).catch((function(){}))}}},l=n,c=(s("1f58"),s("2877")),d=Object(c["a"])(l,i,o,!1,null,"24c3637c",null),u=d.exports,m=s("2f62");function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function g(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function f(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?g(Object(s),!0).forEach((function(t){h(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):g(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function h(e,t,s){return t=b(t),t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function b(e){var t=v(e,"string");return"symbol"==p(t)?t:t+""}function v(e,t){if("object"!=p(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var a=s.call(e,t||"default");if("object"!=p(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var y={name:"message",components:{editRealPerson:u},data:function(){return{selectActive:1,hasList:!1,pageSize:10,pageIndex:1,itemTotal:0,validForm:{},query:{},dataList:[],deleteId:"",deptList:[],queryForm:{groupId:"",realUserName:""}}},computed:f({},Object(m["c"])("personManager",["columns"])),watch:{},created:function(){},mounted:function(){this.getDeptList(),this.getList()},methods:{getDeptList:function(){var e=this;this.$store.dispatch("deptManager/getDeptList").then((function(t){e.deptList=t.data})).catch((function(){}))},getPageList:function(e){this.pageIndex=e,this.getList()},getPageSize:function(e){this.pageIndex=1,this.pageSize=e,this.getList()},searchComm:function(){for(var e in this.validForm={},this.query)this.query[e]&&(this.validForm[e]=this.query[e]);this.pageIndex=1,this.getList()},updatePerson:function(e,t){if(0===e)return this.$refs.editPerson.dialogVisible=!0,this.$refs.editPerson.title="新增",void(this.$refs.editPerson.row={});this.$refs.editPerson.dialogVisible=!0,this.$refs.editPerson.title="修改";var s=[],a=[];!t.groupList||t.groupList.map((function(e){s.push(e.groupId)})),!t.gitLabUser||t.gitLabUser.map((function(e){a.push(e.userId)}));var r={realUserName:t.realUserName,realEmail:t.realEmail,realUserId:t.realUserId,groups:s,userIds:a};this.$refs.editPerson.row=Object.assign({},r)},cancelClose:function(){var e=this;this.$store.dispatch("personManager/deletePerson",{realUserId:this.deleteId}).then((function(t){e.$Message.success("删除成功"),e.getList()})).catch((function(){}))},deletePerson:function(e){this.$refs.confirmModal.dialogVisible=!0,this.$refs.confirmModal.isClose=!0,this.deleteId=e},getList:function(){var e=this,t={pageIndex:this.pageIndex,pageSize:this.pageSize};t=Object.assign(t,this.queryForm),this.$store.dispatch("personManager/getRealPersonList",t).then((function(t){var s=t.data;s.records&&0===s.records.length?e.hasList=!1:(e.hasList=!0,e.dataList=s.records,e.itemTotal=s.total)})).catch((function(){}))}}},L=y,I=(s("2b38"),Object(c["a"])(L,a,r,!1,null,"310b3fbf",null));t["default"]=I.exports}}]);