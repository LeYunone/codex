(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-211974aa"],{"28a6":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[t._m(0),a("div",{staticClass:"main-body"},[a("div",{staticClass:"main-title margin-bottom-20"},[a("Row",{attrs:{gutter:20,type:"flex",justify:"space-between"}},[a("i-col",{staticClass:"text-left",attrs:{span:16}},[a("Row",{attrs:{gutter:20}},[a("i-col",{staticClass:"text-left",attrs:{span:8}},[a("Select",{attrs:{size:"large",placeholder:"请选择项目",filterable:"",clearable:""},model:{value:t.query.realProjectName,callback:function(e){t.$set(t.query,"realProjectName",e)},expression:"query.realProjectName"}},t._l(t.projectName,(function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),a("i-col",{attrs:{span:3}},[a("Button",{directives:[{name:"debounce",rawName:"v-debounce"}],attrs:{size:"large",type:"primary"},on:{click:t.searchList}},[a("span",{staticClass:"fa fa-search"})])],1)],1)],1),a("i-col",{staticClass:"text-left add-btn",attrs:{span:2}},[a("Button",{directives:[{name:"debounce",rawName:"v-debounce"}],staticClass:"add-btn",attrs:{size:"large",type:"primary"},on:{click:function(e){return t.addGitProject(0)}}},[t._v(" 新增 ")])],1)],1)],1),t.hasList?a("div",[a("div",{staticClass:"page-table margin-bottom-20"},[a("Table",{attrs:{columns:t.columns,data:t.dataList,stripe:"",loading:t.tableLoading},scopedSlots:t._u([{key:"projectNames",fn:function(e){return[a("span",[t._v(t._s(t.getProjectName(e)))])]}},{key:"realUserNames",fn:function(e){return[e.row.realUserNames?a("div",t._l(e.row.realUserNames,(function(e,i){return a("Tag",{key:i,attrs:{color:"cyan"}},[t._v(" "+t._s(e)+" ")])})),1):a("span",{staticClass:"no-tip"},[t._v("暂无")])]}},{key:"actions",fn:function(e){return[a("Row",{attrs:{type:"flex",justify:"center",gutter:"20"}},[a("i-col",{attrs:{span:8}},[a("Button",{staticClass:"action-btn",attrs:{type:"dashed",icon:"ios-create"},on:{click:function(a){return t.addGitProject(1,e)}}},[t._v("修改")])],1),a("i-col",{attrs:{span:8}},[a("Button",{staticClass:"delete-btn",attrs:{type:"dashed",icon:"ios-trash-outline"},on:{click:function(a){return t.deleteProject(e.row.realProjectName)}}},[t._v("删除")])],1)],1)]}}],null,!1,986046749)})],1),a("div",{staticClass:"page-footer text-center"},[a("Page",{attrs:{total:t.itemTotal,"page-size-opts":[10,20,40],current:t.pageIndex,"page-size":t.pageSize,"show-elevator":"","show-total":"","show-sizer":""},on:{"on-page-size-change":t.getPageSize,"on-change":t.getPageList}})],1)]):a("div",{staticClass:"main-none"},[a("noListData")],1)]),a("div",[a("projectPerson",{ref:"projectPerson"}),a("addGitProject",{ref:"addGitProject",on:{getList:t.getList}}),a("confirmModal",{ref:"confirmModal",on:{entrueClose:t.cancelClose}},[a("div",{attrs:{slot:"info"},slot:"info"},[a("p",{staticClass:"p-text"},[t._v("确定删除该关联项目？")])])])],1)])},o=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-header margin-bottom-20"},[a("h3",[t._v("项目列表")])])}],r=a("2f62"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Row",{staticClass:"expand-row"},[a("p",{staticClass:"project-name"},[t._v("项目名称:")]),t._l(t.row.projectList,(function(e,i){return a("div",{key:i},[a("p",{staticClass:"expand-key",on:{click:function(a){return t.goToDEtail(e)}}},[t._v(t._s(e.projectName))])])}))],2)],1)},n=[],c={props:{row:Object},data:function(){return{}},mounted:function(){console.log(this.row.projectList)},computed:{},methods:{goToDEtail:function(t){console.log("item--------",t.projectId),this.$router.push({name:"history",params:{projectId:t.projectId}})}}},l=c,d=(a("97d2"),a("2877")),u=Object(d["a"])(l,s,n,!1,null,"1b21d507",null),m=u.exports,p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"editRoleModal page"},[a("Modal",{staticClass:"page-modal",attrs:{width:"20%",title:"项目成员",scrollable:!1,"footer-hide":!0,"class-name":"vertical-center-modal",styles:{top:"-30px"}},model:{value:t.dialogVisible,callback:function(e){t.dialogVisible=e},expression:"dialogVisible"}},[a("div",{staticClass:"modalContainer margin-bottom-100"},[a("div",{staticClass:"main"},t._l(t.row,(function(e,i){return a("div",{key:i,attrs:{size:"large"}},[a("Tag",{attrs:{color:"blue"}},[t._v(" "+t._s(e.realUserName?e.realUserName:e.userName)+" ")])],1)})),0)])])],1)},f=[],h={name:"addModal",data:function(){return{dialogVisible:!1,row:[]}},computed:{},watch:{dialogVisible:function(t){t?console.log(this.row):this.$emit("getList")},isEdit:function(t){this.disabled=!!t}},mounted:function(){},methods:{closeModal:function(){this.dialogVisible=!1}}},g=h,j=(a("5ad6"),Object(d["a"])(g,p,f,!1,null,"729c6d30",null)),b=j.exports,v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"editRoleModal page"},[a("Modal",{staticClass:"page-modal",attrs:{width:"40%",title:t.title,scrollable:!1,"footer-hide":!0,"class-name":"vertical-center-modal",styles:{top:"-30px"}},model:{value:t.dialogVisible,callback:function(e){t.dialogVisible=e},expression:"dialogVisible"}},[t.loadingShow?a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"demo-spin-icon-load",attrs:{type:"ios-loading",size:"18"}}),a("div",[t._v("Loading")])],1):t._e(),a("div",{staticClass:"modalContainer margin-bottom-100"},[a("Form",{ref:"addForm",staticClass:"form-box",attrs:{"label-width":130,model:t.addForm,"label-colon":"",rules:t.ruleValidate}},[a("FormItem",{attrs:{label:"真实项目名",prop:"realProjectNames"}},[a("Select",{attrs:{size:"large",placeholder:"请选择真实系统",filterable:"",clearable:"",disabled:t.isEdit},model:{value:t.addForm.realProjectName,callback:function(e){t.$set(t.addForm,"realProjectName",e)},expression:"addForm.realProjectName"}},t._l(t.projectName,(function(e){return a("Option",{attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),a("FormItem",{attrs:{label:"Git项目名"}},[a("Select",{attrs:{size:"large",placeholder:"请选择项目名称",filterable:"",clearable:"",multiple:""},model:{value:t.addForm.projectIds,callback:function(e){t.$set(t.addForm,"projectIds",e)},expression:"addForm.projectIds"}},t._l(t.projectList,(function(e){return a("Option",{key:e.projectId+e.projectName,attrs:{value:e.projectId}},[t._v(t._s(e.projectName))])})),1)],1)],1)],1),a("div",{staticClass:"detailBackBtn margin-bottom-40"},[a("Button",{attrs:{size:"large"},on:{click:function(e){return t.closeModal()}}},[t._v(t._s(t.$t("common.cancel")))]),a("Button",{attrs:{type:"primary",size:"large"},on:{click:function(e){return t.handleSubmit()}}},[t._v(t._s(t.$t("common.ensure")))])],1)],1)],1)},y=[],P={name:"addModal",data:function(){return{loadingShow:!1,dialogVisible:!1,addForm:{projectIds:[],realProjectName:""},ruleValidate:{gitProject:[{required:!0,message:"请输入Git项目名",trigger:"blur"}]},userLists:[],isEdit:!1,row:{},disabled:!1,title:"新增",projectName:[],projectList:[]}},watch:{dialogVisible:function(t){t?(this.addForm=this.row,console.log("this.addForm",this.addForm),this.getBugSystemName(),this.getProjectNameList()):(this.handleReset(),this.$emit("getList"))},isEdit:function(t){this.disabled=!!t}},methods:{handleReset:function(){this.$refs.addForm.resetFields(),this.addForm=this.$options.data.call(this).addForm},closeModal:function(){this.dialogVisible=!1,this.handleReset(),clearInterval(this.timer)},handleSubmit:function(){var t=this;this.$refs.addForm.validate((function(e){e&&t.updateProject()}))},updateProject:function(){var t=this,e={realProjectNames:[this.addForm.realProjectName],projectIds:this.addForm.projectIds};this.isEdit?e.type=1:e.type=0,this.$store.dispatch("projectManager/relationRealProject",e).then((function(e){404!==Number(e.code)?(t.$message({type:"success",message:"操作成功"}),t.$emit("getList"),t.dialogVisible=!1):t.$message({type:"error",message:e.message+"，请重新输入"})})).catch((function(){}))},getBugSystemName:function(){var t=this;this.$store.dispatch("bugDetails/getBugSystemName").then((function(e){var a=e.data;a.projectName.forEach((function(e){t.projectName.push({value:e,label:e})}))})).catch((function(){}))},getProjectNameList:function(){var t=this,e={type:1};this.$store.dispatch("commit/getProjectNameList",e).then((function(e){t.projectList=e.data})).catch((function(){}))}}},N=P,w=(a("2bfa"),Object(d["a"])(N,v,y,!1,null,"2554a9c7",null)),_=w.exports;a("f825");function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function $(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function C(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?$(Object(a),!0).forEach((function(e){S(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):$(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function S(t,e,a){return e=x(e),e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function x(t){var e=O(t,"string");return"symbol"==L(e)?e:e+""}function O(t,e){if("object"!=L(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var i=a.call(t,e||"default");if("object"!=L(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var k={components:{expandRow:m,projectPerson:b,addGitProject:_},data:function(){var t=this;return{dataList:[],hasList:!1,pageSize:10,pageIndex:1,itemTotal:0,options2:{disabledDate:function(e){if(t.endMonth){var a=t.getDate(t.endMonth);return e&&e>a||e>new Date}return e&&e>new Date}},projectId:"",startDate:"",endDate:"",projectName:[],department:[],projectList:[],query:{realProjectName:""},tableLoading:!1,deleteRealProjectNames:""}},computed:C(C({},Object(r["c"])("projectManager",["columns"])),{},{getProjectName:function(){return function(t){return t.row.projectNames?t.row.projectNames.join(","):""}}}),mounted:function(){this.getProjectNameList(),this.getList(),this.getBugSystemName()},methods:{getPageList:function(t){this.pageIndex=t,this.getList()},getPageSize:function(t){this.pageIndex=1,this.pageSize=t,this.getList()},searchList:function(){this.pageIndex=1,this.getList()},getList:function(){var t=this;this.tableLoading=!0;var e={pageIndex:this.pageIndex,pageSize:this.pageSize,realProjectName:this.query.realProjectName};this.$store.dispatch("projectManager/relationList",e).then((function(e){var a=e.data;a.records&&0==a.records.length?t.hasList=!1:(t.hasList=!0,t.dataList=a.records,t.itemTotal=a.total),t.tableLoading=!1})).catch((function(){t.tableLoading=!1}))},detail:function(t){this.$refs.projectPerson.dialogVisible=!0,this.$refs.projectPerson.row=t.row.users},changeTime:function(t){this.startDate=t},addGitProject:function(t,e){if(this.$refs.addGitProject.dialogVisible=!0,1===t){var a={realProjectName:e.row.realProjectName,projectIds:e.row.projectIds};this.$refs.addGitProject.title="修改",this.$refs.addGitProject.row=a,this.$refs.addGitProject.isEdit=!0}else this.$refs.addGitProject.title="新增",this.$refs.addGitProject.isEdit=!1,this.$refs.addGitProject.row={}},getBugSystemName:function(){var t=this;this.$store.dispatch("bugDetails/getBugSystemName").then((function(e){var a=e.data;a.projectName.forEach((function(e){t.projectName.push({value:e,label:e})}))}))},getProjectNameList:function(){var t=this,e={type:1};this.$store.dispatch("commit/getProjectNameList",e).then((function(e){t.projectList=e.data})).catch((function(){}))},deleteProject:function(t){console.log("row",t),this.$refs.confirmModal.dialogVisible=!0,this.$refs.confirmModal.isClose=!0,this.deleteRealProjectNames=t},cancelClose:function(){var t=this,e={realProjectNames:[this.deleteRealProjectNames],projectIds:[],type:1};this.$store.dispatch("projectManager/relationRealProject",e).then((function(e){t.$Message.success("删除成功"),t.getList()})).catch((function(){}))}}},I=k,F=(a("c109"),Object(d["a"])(I,i,o,!1,null,"2f5f5ebe",null));e["default"]=F.exports},"2bfa":function(t,e,a){"use strict";a("a302")},"5ad6":function(t,e,a){"use strict";a("6928")},6928:function(t,e,a){},"90c3":function(t,e,a){},"97d2":function(t,e,a){"use strict";a("90c3")},a302:function(t,e,a){},c109:function(t,e,a){"use strict";a("e639")},e639:function(t,e,a){}}]);